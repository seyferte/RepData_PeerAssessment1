{
    "contents" : "## Processing\n## Load data, ensure date is formatted\n\nraw.data <- read.csv(\"activity.csv\", colClasses = c(\"integer\", \"Date\", \"integer\"))\ndates = unique(raw.data$date)\nintervals = unique(raw.data$interval)\n\n## Find interval means and medians\nclean.interval.means <- as.numeric()\ni <- 0\nfor(i in 1:length(intervals)){\n  working.steps <- subset(raw.data, interval==intervals[i], select = steps)\n  clean.interval.means[i] <- mean(working.steps$steps, na.rm=TRUE)\n}\nclean.interval.means <- cbind(intervals,clean.interval.means)\ncolnames(clean.interval.means) <- c(\"interval\", \"mean\")\n\n## Find date sums\nclean.date.sums <- as.integer()\ni <- 0\nfor(i in 1:length(dates)){\n  working.steps <- subset(raw.data, date==dates[i], select = steps)\n  clean.date.sums[i] <- sum(working.steps$steps, na.rm=TRUE)\n}\nclean.date.sums <- cbind.data.frame(dates,clean.date.sums)\ncolnames(clean.date.sums) <- c(\"date\",\"total\")\n\n## What is mean total number of steps taken per day?\n## 1 Histogram\nhist(clean.date.sums$total)\nplot(clean.date.sums)\n## 2 Average and median for all dates\ndaily.mean = mean(clean.date.sums$total, na.rm = TRUE)\ndaily.median = median(clean.date.sums$total, na.rm = TRUE)\n\n## What is the average daily activity pattern?\n## Time Series plot\nplot(clean.interval.means, type = \"l\")\nmax.interval <- clean.interval.means[which.max(clean.interval.means[,2])]\n## Imputing missing values\n## 1. NAs\nlength(which(is.na(raw.data$steps)))\n## 2. & 3. Fillin NAs using average interval coerced to integer\nsimulated.data <- raw.data\nobservations <- length(simulated.data[,1])\n\ni <- 0\nfor(i in 1:observations){\n  if(is.na(simulated.data[i,1])){\n    working.interval = simulated.data[i,3]\n    simulated.data$steps[i] = \n      as.integer(round(clean.interval.means[(which(intervals == working.interval)),2], digits = 0))\n  }\n}\n\n## 4. new histogram, mean and median\nsimulated.date.sums <- as.integer()\ni <- 0\nfor(i in 1:length(dates)){\n  working.steps <- subset(simulated.data, date==dates[i], select = steps)\n  simulated.date.sums[i] <- sum(working.steps$steps, na.rm=TRUE)\n}\nsimulated.date.sums <- cbind.data.frame(dates,simulated.date.sums)\ncolnames(simulated.date.sums) <- c(\"date\",\"total\")\n\nhist(simulated.date.sums$total)\ndaily.mean.simulated = mean(simulated.date.sums$total, na.rm = TRUE)\ndaily.median.simulated = median(simulated.date.sums$total, na.rm = TRUE)\n\n## Are there differences in activity patterns between weekdays and weekends?\ni <- 0\nweekday.value <- as.character()\nfor(i in 1:observations){\n  weekday.value[i] <- weekdays(simulated.data$date[i], abbreviate=TRUE)\n}\n\nsimulated.data <- cbind.data.frame(simulated.data,weekday.value)\n## Weekend\nsimulated.data.weekend <- subset(simulated.data, weekday.value == c(\"Sat\", \"Sun\"))\n##weekend.dates = unique(simulated.data.weekend$date)\n##simulated.date.sums.weekend <- as.integer()\n##i <- 0\n##for(i in 1:length(weekend.dates)){\n##  working.steps <- subset(simulated.data.weekend, date==weekend.dates[i], select = steps)\n##  simulated.date.sums.weekend[i] <- sum(working.steps$steps, na.rm=TRUE)\n##}\n##simulated.date.sums.weekend <- cbind.data.frame(weekend.dates,simulated.date.sums.weekend)\n##colnames(simulated.date.sums.weekend) <- c(\"date\",\"total\")\n## Weekend Intervals\n\nsimulated.data.weekend <- subset(simulated.data, weekday.value == c(\"Sat\", \"Sun\"))\nweekend.interval.means <- as.numeric()\ni <- 0\nfor(i in 1:length(intervals)){\n  working.steps <- subset(simulated.data.weekend, interval==intervals[i], select = steps)\n  weekend.interval.means[i] <- mean(working.steps$steps, na.rm=TRUE)\n}\nweekend.interval.means <- cbind(intervals,weekend.interval.means)\ncolnames(weekend.interval.means) <- c(\"interval\", \"mean\")\nplot(weekend.interval.means, type = \"l\")\n\n## Workweek\nsimulated.data.mon <- subset(simulated.data, weekday.value == \"Mon\")\nsimulated.data.tue <- subset(simulated.data, weekday.value == \"Tue\")\nsimulated.data.wed <- subset(simulated.data, weekday.value == \"Wed\")\nsimulated.data.thu <- subset(simulated.data, weekday.value == \"Thu\")\nsimulated.data.fri <- subset(simulated.data, weekday.value == \"Fri\")\nsimulated.data.workweek <- rbind(simulated.data.mon,simulated.data.tue,simulated.data.wed,simulated.data.thu,simulated.data.fri)\nworkweek.interval.means <- as.numeric()\ni <- 0\nfor(i in 1:length(intervals)){\n  working.steps <- subset(simulated.data.workweek, interval==intervals[i], select = steps)\n  workweek.interval.means[i] <- mean(working.steps$steps, na.rm=TRUE)\n}\nworkweek.interval.means <- cbind(intervals,workweek.interval.means)\ncolnames(workweek.interval.means) <- c(\"interval\", \"mean\")\nplot(workweek.interval.means, type = \"l\")\n\nset.panel(2,1)\nplot(weekend.interval.means, type = \"l\")\nplot(workweek.interval.means, type = \"l\")\n##workweek.dates = unique(simulated.data.workweek$date)\n##simulated.date.sums.workweek <- as.integer()\n##i <- 0\n##for(i in 1:length(dates)){\n##  working.steps <- subset(simulated.data.workweek, date==workweek.dates[i], select = steps)\n##  simulated.date.sums.workweek[i] <- sum(working.steps$steps, na.rm=TRUE)\n##}\n##simulated.date.sums.workweek <- cbind.data.frame(dates,simulated.date.sums.workweek)\n##colnames(simulated.date.sums.workweek) <- c(\"date\",\"total\")\n",
    "created" : 1402845255211.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2633026302",
    "id" : "7023942A",
    "lastKnownWriteTime" : 1402868969,
    "path" : "~/GitHub/RepData_PeerAssessment1/repdata-003_coding.R",
    "project_path" : "repdata-003_coding.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}