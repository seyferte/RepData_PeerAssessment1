{
    "contents" : "# Reproducible Research: Peer Assessment 1\n\n\n## Loading and preprocessing the data\n```{r}\nraw.data <- read.csv(\"activity.csv\", colClasses = c(\"integer\", \"Date\", \"integer\"))\ndates = unique(raw.data$date)\nintervals = unique(raw.data$interval)\n```\n\n\n## What is mean total number of steps taken per day?\n```{r}\nclean.date.sums <- as.integer()\ni <- 0\nfor(i in 1:length(dates)){\n  working.steps <- subset(raw.data, date==dates[i], select = steps)\n  clean.date.sums[i] <- sum(working.steps$steps, na.rm=TRUE)\n}\nclean.date.sums <- cbind.data.frame(dates,clean.date.sums)\ncolnames(clean.date.sums) <- c(\"date\",\"total\")\n```\nHistogram:\n```{r}\nhist(clean.date.sums$total)\n```\n\nMean and Median:\n```{r}\ndaily.mean = mean(clean.date.sums$total, na.rm = TRUE)\ndaily.median = median(clean.date.sums$total, na.rm = TRUE)\n```\nThe mean is `r daily.mean` and the median is `r daily.median`\n\n## What is the average daily activity pattern?\n\nTime Series:\n```{r}\nclean.interval.means <- as.numeric()\ni <- 0\nfor(i in 1:length(intervals)){\n  working.steps <- subset(raw.data, interval==intervals[i], select = steps)\n  clean.interval.means[i] <- mean(working.steps$steps, na.rm=TRUE)\n}\nclean.interval.means <- cbind(intervals,clean.interval.means)\ncolnames(clean.interval.means) <- c(\"interval\", \"mean\")\nmax.interval <- clean.interval.means[which.max(clean.interval.means[,2])]\nplot(clean.interval.means, type = \"l\")\n```\n\nThe interval with the maximum number of steps is `r max.interval`\n\n## Imputing missing values\n``` {r}\ntotal.na <- length(which(is.na(raw.data$steps)))\n```\nThe total number of NA's in the raw dataset is `r total.na` \n\nThe missing values will be filled using the rounded interval mean for a missing data point. The new dataset is called simulated.data.\n\n``` {r}\nsimulated.data <- raw.data\nobservations <- length(simulated.data[,1])\n\ni <- 0\nfor(i in 1:observations){\n  if(is.na(simulated.data[i,1])){\n    working.interval = simulated.data[i,3]\n    simulated.data$steps[i] = \n      as.integer(round(clean.interval.means[(which(intervals == working.interval)),2], digits = 0))\n  }\n}\n```\n\nHistogram:\n\n```{r}\nsimulated.date.sums <- as.integer()\ni <- 0\nfor(i in 1:length(dates)){\n  working.steps <- subset(simulated.data, date==dates[i], select = steps)\n  simulated.date.sums[i] <- sum(working.steps$steps, na.rm=TRUE)\n}\nsimulated.date.sums <- cbind.data.frame(dates,simulated.date.sums)\ncolnames(simulated.date.sums) <- c(\"date\",\"total\")\ndaily.mean.simulated = mean(simulated.date.sums$total, na.rm = TRUE)\ndaily.median.simulated = median(simulated.date.sums$total, na.rm = TRUE)\nhist(simulated.date.sums$total)\n```\n\nFor the simulated dataset, the mean is `r round(daily.mean.simulated, digits=2)` and the median is `r daily.median.simulated`. By adding the simulated values the mean and median have drifted higher.\n\n\n## Are there differences in activity patterns between weekdays and weekends?\nWeekend Data:\n```{r}\ni <- 0\nweekday.value <- as.character()\nfor(i in 1:observations){\n  weekday.value[i] <- weekdays(simulated.data$date[i], abbreviate=TRUE)\n}\nsimulated.data <- cbind.data.frame(simulated.data,weekday.value)\nsimulated.data.weekend <- subset(simulated.data, weekday.value == c(\"Sat\", \"Sun\"))\nweekend.interval.means <- as.numeric()\ni <- 0\nfor(i in 1:length(intervals)){\n  working.steps <- subset(simulated.data.weekend, interval==intervals[i], select = steps)\n  weekend.interval.means[i] <- mean(working.steps$steps, na.rm=TRUE)\n}\nweekend.interval.means <- cbind(intervals,weekend.interval.means)\ncolnames(weekend.interval.means) <- c(\"interval\", \"mean\")\n```\n\nWorkweek Data:\n```{r}\nsimulated.data.mon <- subset(simulated.data, weekday.value == \"Mon\")\nsimulated.data.tue <- subset(simulated.data, weekday.value == \"Tue\")\nsimulated.data.wed <- subset(simulated.data, weekday.value == \"Wed\")\nsimulated.data.thu <- subset(simulated.data, weekday.value == \"Thu\")\nsimulated.data.fri <- subset(simulated.data, weekday.value == \"Fri\")\nsimulated.data.workweek <- rbind(simulated.data.mon,simulated.data.tue,simulated.data.wed,simulated.data.thu,simulated.data.fri)\nworkweek.interval.means <- as.numeric()\ni <- 0\nfor(i in 1:length(intervals)){\n  working.steps <- subset(simulated.data.workweek, interval==intervals[i], select = steps)\n  workweek.interval.means[i] <- mean(working.steps$steps, na.rm=TRUE)\n}\nworkweek.interval.means <- cbind(intervals,workweek.interval.means)\ncolnames(workweek.interval.means) <- c(\"interval\", \"mean\")\n```\n\nPanel Plot:\n```{r}\nlibrary(fields)\nset.panel(2,1)\nplot(weekend.interval.means, type = \"l\")\nplot(workweek.interval.means, type = \"l\")\n```\n",
    "created" : 1402869362302.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2287984396",
    "id" : "CBB8701D",
    "lastKnownWriteTime" : 1402869224,
    "path" : "~/GitHub/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}